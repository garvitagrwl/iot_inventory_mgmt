{% extends 'base_layout.html' %}
{% load static %}

{% block css_filename %}base/login_page.css{% endblock %}

<!--title  of webpage-->
{% block page_title %}Login user{% endblock %}


{% block js_filename %}base/js/loginform_toggle.js{% endblock %}


<!-- <body> -->
{% block page_content %}
  <div class="logo-container" style="text-align: center; margin-bottom: 20px; margin-right: 25px;">
    <a href="/">
        <img src="{% static 'base/images/skitlogo.png' %}" alt="Logo" style="width: 80px;height: auto;">
    </a>
  </div>

  <div class="test-header">
    <h1>IoT Lab Portal</h1>
  </div>

<div class="auth-container">
    <div class="tab-buttons">
      <button onclick="showForm('student')">Student</button>
      <button onclick="showForm('faculty')">Faculty</button>
    </div>

    <div id="student" class="form-section{% if step != 'student' and step %} hidden{% endif %}">
      <h2>Student Login</h2>
{% if messages %}
  <div class="message-container">
    {% for message in messages %}
      <p class="error-message">{{ message }}</p>
    {% endfor %}
  </div> 
{% endif %}
      <form method="POST" action="{% url 'login' %}">
        {% csrf_token %}
        <input type="hidden" name="form_type" value="user_login">
        <input type="email" name="email" placeholder="College Email" required />
        <input type="password" name="password" placeholder="Password / OTP" required />
         <button type="submit">Login</button>
        
        <a href="{% url 'verify_email' %}" class="switch-link">New user? Sign up here</a>
      </form>
    </div>

      <div id="studentSignup" class="form-section{% if step != 'email' and step %} hidden{% endif %}">
  <h2>Student Email Verification</h2>
  <form method="POST" action="{% url 'verify_email' %}">
    {% csrf_token %}
    {{ form.email }}
    <button type="submit">Send OTP</button>
  </form>
</div>

<div id="enterOtp" class="form-section{% if step != 'otp' %} hidden{% endif %}">
  <h2>Enter OTP</h2>
  <form method="POST" action="{% url 'enter_otp' %}">
    {% csrf_token %}
    {{ form.code }}
    <button type="submit"">Verify OTP</button>
  </form>
  <p><a href="{% url 'resend_otp' %}">Resend OTP</a></p>
</div>

<div id="completeRegistration" class="form-section{% if step != 'register' %} hidden{% endif %}">
  <h2>Complete Registration</h2>
  {% if messages %}
  <div class="message-container">
    {% for message in messages %}
      <p class="error-message">{{ message }}</p>
    {% endfor %}
  </div> 
{% endif %}
  <form method="POST" action="{% url 'complete_registration' %}">
    {% csrf_token %}
    <input type="email" value="{{ email }}" readonly>
    <input type="text" name="full_name" placeholder="Full Name" value="{{ form.full_name.value|default:'' }}" required>
<input type="text" name="roll_number" placeholder="Roll Number" value="{{ form.roll_number.value|default:'' }}" required>
<input type="tel" name="contact_number" placeholder="Contact Number" value="{{ form.contact_number.value|default:'' }}" required>
<input type="password" name="password" placeholder="Password" required>
    <button type="submit">Register</button>
  </form>
</div>

    

    <div id="faculty"  class="form-section hidden">
      <h2>Faculty Login</h2>
      <form method="POST" action="{% url 'admindash2' %}">
        {% csrf_token %}
        <input type="text" name="username" placeholder="Faculty Username" required />
        <input type="password" name="password" placeholder="Password" required />
        <button type="submit">Login</button>
      </form>
    </div>
  </div>
{% endblock %}