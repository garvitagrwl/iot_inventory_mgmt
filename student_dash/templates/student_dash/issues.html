{% extends 'base/studentdashboard.html' %}
{% load static %}
{% block page_title %}Student Isssued Items{% endblock %}

{% block extra_css_files %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'student_dash/issues.css' %}">
{% endblock %}

    
{% block page_header %}{% endblock %}

{% block dashboard_content %}
<div class="container">
    <h2>Issued Items</h2>

    <!-- Current Issued Items -->
    <section>
        <h3 class="section-title">ðŸ“Œ Currently Issued Components</h3>
        {% if grouped_current %}
            {% for category, items in grouped_current.items %}
                <div class="category-block">
                    <h4>{{ category }}</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Component</th>
                                <th>Quantity</th>
                                <th>Form Date</th>
                                <th>Issue Date</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for i in items %}
                            <tr>
                                <td>{{ i.component__name }}</td>
                                <td>{{ i.quantity_issued }}</td>
                                <td>{{ i.form_date }}</td>
                                <td>{{ i.issue_date }}</td>
                                <td class="status {{ i.status_from_student|lower }}">{{ i.status_from_student }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% endfor %}
        {% else %}
            <p class="empty">No current issues.</p>
        {% endif %}
    </section>

    <!-- Previously Issued Items -->
    <section>
        <h3 class="section-title">ðŸ“¦ Previously Issued (Returned) Components</h3>
        {% if grouped_previous %}
            {% for category, items in grouped_previous.items %}
                <div class="category-block">
                    <h4>{{ category }}</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Component</th>
                                <th>Quantity</th>
                                <th>Form Date</th>
                                <th>Issue Date</th>
                                <th>Return Date</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for i in items %}
                            <tr>
                                <td>{{ i.component__name }}</td>
                                <td>{{ i.quantity_issued }}</td>
                                <td>{{ i.form_date }}</td>
                                <td>{{ i.issue_date }}</td>
                                <td>{{ i.return_date }}</td>
                                <td class="status {{ i.status_from_student|lower }}">{{ i.status_from_student }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% endfor %}
        {% else %}
            <p class="empty">No previous issues.</p>
        {% endif %}
    </section>
</div>
{% endblock %}
