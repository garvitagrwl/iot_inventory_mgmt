{% extends 'base/studentdashboard.html' %}
{% load static %}

{% block page_title %}Components Items{% endblock %}

{% block js_filename %}
  <script src="{% static 'student_dash/js/sidebar.js' %}"></script>
  <script src="{% static 'student_dash/js/listcomponent_bycategory.js' %}"></script>
{% endblock %}

{% block page_header %}{% endblock %}

{% block dashboard_content %}
<style>
  .right-sidebar {
    position: fixed;
    top: 0;
    right: -350px;
    width: 350px;
    height: 100%;
    background: white;
    box-shadow: -3px 0 6px rgba(0, 0, 0, 0.2);
    padding: 20px;
    overflow-y: auto;
    z-index: 1000;
    transition: right 0.3s ease-in-out;
}

.right-sidebar.open {
    right: 0;
}

.request-btn-top-right {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 1100;
    background-color: #4CAF50;
    color: white;
    border: none;
    padding: 10px 15px;
    cursor: pointer;
    border-radius: 4px;
}
.sidebar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}


</style>
          <button id="toggleSidebarBtn" class="request-btn-top-right" style="position: fixed; top: 20px; right: 20px; z-index: 1001;">
            Request Components
        </button>
<a href="{% url 'dash:components' %}" class="btn btn-secondary" style="margin-bottom: 15px;">‚Üê Back to Categories</a>

<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;padding: 20px;">
  <h3 style="margin: 10px 0;">Components in {{ category_name }}</h3>
  <input type="text" id="searchInput" placeholder="Search component..." onkeyup="filterComponents()" style="width: 300px; padding: 8px;">
</div>


<!-- Components List -->
<div id="componentList" style="width: 95%; margin: auto;">
  {% for item in components %}
    <div class="component-item"
         data-name="{{ item.name|lower }}"
         style="display: flex; align-items: center; justify-content: space-between; padding: 10px; border: 1px solid #ccc; margin-bottom: 10px; border-radius: 8px;">

      <div style="flex: 2;"><strong>{{ item.name }}</strong></div>
      <div style="flex: 1;">Available: {{ item.quantity }}</div>
      <div style="flex: 1;">Status: {{ item.status }}</div>

      <div style="flex: 0.5;" id="control-{{ item.id }}">
        {% if item.quantity > 0 %}
          <!-- <button onclick="startQuantityControl({{ item.id }}, {{ item.quantity }}, '{{ item.component_name|escapejs }}')">Add</button> -->
           <button onclick="startQuantityControl({{ item.id }}, {{ item.quantity }}, '{{ item.name|escapejs }}')">Add</button>
        {% else %}
          <button disabled>Out of Stock</button>
        {% endif %}
      </div>
    </div>
  {% endfor %}
</div>

<!-- No Match Message -->
<div id="noResult" style="text-align:center; display:none; color:gray; margin-top: 20px;">
  No matching components found.
</div>
<div id="requestSidebar" class="right-sidebar">
            <div class="sidebar-header">
                <h4>Selected Components</h4>
                <button id="closeSidebar">&times;</button>
            </div>
            <form id="componentRequestForm" method="POST" action="{% url 'dash:submit_request' %}">
                {% csrf_token %}
                <div id="form-hidden-fields"></div>
                <div id="selected-components-list">
                    <p>No components selected yet.</p>
                </div>
                <button type="submit" class="btn btn-primary mt-3">Confirm Request</button>
            </form>
        </div>

{% endblock %}








