{% extends 'base_layout.html' %}

<!--css name-->
{% block css_filename %}student_dash/admin-dashboard.css{% endblock %}

<!--title  of webpage-->
{% block page_title %}welcome admin{% endblock %}

{% block page_content%}
  <div class="admin-container">
    <aside class="admin-sidebar">
      <h2>Admin Panel</h2>
      <ul>
        <li><a href="{% url 'dash:approved_requests' %}">Approved Requests</a></li>
        <li><a href="{% url 'dash:rejected_requests' %}">Rejected Requests</a></li>
        <li><a href="inventory.html">Inventory</a></li>
<!--        <li><a href="project-tracker.html">Project Tracker</a></li>-->
        <li><a href="index.html">Logout</a></li>
      </ul>
    </aside>

    <main class="admin-main">
      <header>
        <h1>Welcome, Admin</h1>
        <p>Manage all student requests and lab inventory.</p>
      </header>

<!--      <section class="admin-cards">-->
<!--        <div class="admin-card">-->
<!--          <h3>Pending Form Requests</h3>-->

<!--          {% comment %}<p>{{ requests_distinct.count }}</p>{% endcomment %}-->
<!--        </div>-->
<!--&lt;!&ndash;        <div class="admin-card">&ndash;&gt;-->
<!--&lt;!&ndash;          <h3>Low Stock Alerts</h3>&ndash;&gt;-->
<!--&lt;!&ndash;          <p>2</p>&ndash;&gt;-->
<!--&lt;!&ndash;        </div>&ndash;&gt;-->
<!--&lt;!&ndash;        <div class="admin-card">&ndash;&gt;-->
<!--&lt;!&ndash;          <h3>Active Projects</h3>&ndash;&gt;-->
<!--&lt;!&ndash;          <p>6</p>&ndash;&gt;-->
<!--&lt;!&ndash;        </div>&ndash;&gt;-->
<!--      </section>-->







{% comment "used to check this dicctionsry" %}
<pre>{{ grouped_requests.items }}</pre>
      {% endcomment %}
      <section>
{% for category, requests in grouped_requests.items %}

    <details open style="margin-bottom: 30px;">
        <summary style="font-weight: bold;">{{ category }}</summary>

        <table border="1" cellspacing="0" cellpadding="8" style="margin-top: 10px; width: 100%;">
            <thead>
                <tr>
                    <th>Student</th>
                    <th>Roll No.</th>
                    <th>Component</th>
                    <th>Quantity Issued</th>
                    <th>Currently Available</th>
                    <th>Form Date</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for req in requests %}
                <tr>
                    <td>{{ req.student__full_name }}</td>
                    <td>{{ req.student__roll_number }}</td>
                    <td>{{ req.component__name }}</td>
                    <td>{{ req.quantity_issued }}</td>
                    <td>{{ req.component__quantity }}</td>
                    <td>{{ req.form_date}}</td>
                  <td>
                    <form method="POST" action="{% url 'dash:update_status' %}">
      {% csrf_token %}
      <input type="hidden" name="roll_number" value="{{ req.student__roll_number }}">
      <input type="hidden" name="form_date" value="{{ req.form_date|date:'Y-m-d' }}">
      <input type="hidden" name="component_name" value="{{ req.component__name }}">

      <button name="action" value="approve">Approve</button>
      <button name="action" value="reject">Reject</button>
    </form>
                  </td>

                </tr>
                {% endfor %}
            </tbody>
        </table>
    </details>
{% endfor %}
        </section>
    </main>
  </div>
{% endblock %}
