{% extends 'base_layout.html' %}
{% load static %}


{% comment %}
{% extends 'base/studentdashboard.html' %}
{% endcomment %}

{% block page_title %}Components Items{% endblock %}

{% block js_filename %}student_dash/js/inv_items.js{% endblock %}

{% block page_content %}

<a href="{% url 'dash:components' %}" class="btn btn-secondary" style="margin-bottom: 15px;">‚Üê Back to Categories</a>


<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding: 20px;">
  <h3 style="margin: 0;">Components in {{ category_name }}</h3>

  {% comment %} <div style="display: flex; align-items: center; gap: 10px;">
    <button id="openAddRow" style="padding: 8px 12px; background-color: #4CAF50; color: white; border: none; border-radius: 4px;">
        + Add Component
    </button> {% endcomment %}


{% comment %} <!-- hidden form that shows when button is clicked -->
<form id="addComponentForm" method="POST" action="{% url 'dash:add_component' %}" style="display:none;margin-top:15px;">
    {% csrf_token %}
    <input type="text" name="component_name" placeholder="Component Name" required>
    <input type="number" name="component_qty" placeholder="Qty" min="0" required>

    <button type="submit"
            style="padding:5px 10px;background:#4CAF50;color:white;border:none;border-radius:4px;">
        Save
    </button>

    <button type="button" id="cancelForm"
            style="padding:5px 10px;background:#f44336;color:white;border:none;border-radius:4px;">
        Cancel
    </button>
</form> {% endcomment %}

    <input type="text" id="searchInput" placeholder="Search component..."
           onkeyup="filterComponents()" 
           style="width: 300px; padding: 8px;">
  </div>
</div>

<!-- Components List -->
<div id="componentList" style="width: 95%; margin: auto;">
  {% for item in components %}
    <div class="component-item"
         data-name="{{ item.name|lower }}"
         style="display: flex; align-items: center; justify-content: space-between; padding: 10px; border: 1px solid #ccc; margin-bottom: 10px; border-radius: 8px;">
      <div style="flex: 2;"><strong>{{ item.name }}</strong></div>
      <div style="flex: 1;">Available: {{ item.quantity }}    Status : {{item.componentstatus}}</div>
<!--        <button type="submit"-->
<!--                    style="background-color: red; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer;">-->
<!--                change entity-->
<!--        </button>-->
        <form action="{% url 'dash:deletecomp' %}" method="post" style="margin: 0;">
            {% csrf_token %}
            <input type="hidden" name="comp_name" value="{{ item.name }}">
            <input type="hidden" name="comp_category" value="{{ category_name }}">

        <button type="submit"
                style="background-color: red; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer;">
                Delete
        </button>
        </form>

    </div>

  {% endfor %}
</div>

<!-- No Match Message -->
<div id="noResult" style="text-align:center; display:none; color:gray; margin-top: 20px;">
  No matching components found.
</div>
{% endblock %}
